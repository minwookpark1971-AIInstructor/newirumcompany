<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•ì‚¬ ì»¤ë®¤ë‹ˆí‹° | Irum Academy</title>
    <meta name="description" content="ê°•ì‚¬ë“¤ê³¼ ì§€ì‹ì„ ê³µìœ í•˜ê³  í•¨ê»˜ ì„±ì¥í•˜ì„¸ìš”">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/animations.css">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
</head>
<body>
    <!-- Header -->
    <div id="header-container"></div>

    <!-- Page Hero -->
    <section class="page-hero" style="background-image: url('../images/backgrounds/community-banner.png'); background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: scroll; padding-top: 120px; min-height: calc(50vh - 300px); display: flex; align-items: center; justify-content: center; padding-bottom: 3rem; position: relative; transform: translate3d(0, 0, 0); -webkit-transform: translate3d(0, 0, 0); backface-visibility: hidden; -webkit-backface-visibility: hidden;">
        <div class="page-hero-overlay" style="position: absolute; inset: 0; background: rgba(255, 255, 255, 0.6); z-index: 0;"></div>
        <div class="container" style="position: relative; z-index: 1; width: 100%; max-width: 1200px; margin: 0 auto; padding: 0 1.5rem;">
            <div class="page-hero-content reveal-up" style="text-align: center !important; width: 100% !important; margin: 0 auto !important; padding: 0 !important; color: #000000 !important; max-width: 100% !important;">
                <h1 class="page-hero-title" style="color: #000000 !important; text-shadow: none !important;">ê°•ì‚¬ ì»¤ë®¤ë‹ˆí‹°</h1>
                <p style="font-size: 1.125rem; margin-top: 1rem; color: var(--text-muted);">
                    ê°•ì‚¬ë“¤ê³¼ ì§€ì‹ì„ ê³µìœ í•˜ê³  í•¨ê»˜ ì„±ì¥í•˜ì„¸ìš”
                </p>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <main class="main-content" style="background-color: #ffffff; padding-top: 2rem; padding-bottom: 3rem;">
        <section class="section">
            <div class="container">
                <!-- Login Banner -->
                <div class="card card-elevated reveal-up" id="login-banner" style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(37, 99, 235, 0.1)); border: 1px solid rgba(37, 99, 235, 0.2); margin-bottom: 2rem;">
                    <div class="card-content" style="display: flex; flex-direction: column; gap: 1rem; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 0.75rem;">
                            <span style="font-size: 1.25rem;">ğŸ””</span>
                            <div>
                                <p style="font-weight: 500;">ë¡œê·¸ì¸í•˜ê³  ì»¤ë®¤ë‹ˆí‹°ì— ì°¸ì—¬í•˜ì„¸ìš”</p>
                                <p style="font-size: 0.875rem; color: var(--text-muted);">
                                    ê²Œì‹œê¸€ ì‘ì„±, ëŒ“ê¸€, ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤
                                </p>
                            </div>
                        </div>
                        <a href="auth/login.html" class="btn btn-primary">ë¡œê·¸ì¸í•˜ê¸°</a>
                    </div>
                </div>

                <!-- Search Bar -->
                <div class="search-bar reveal-up" style="margin-bottom: 1.5rem;">
                    <div style="position: relative; max-width: 500px; margin: 0 auto;">
                        <input 
                            type="search" 
                            id="search-input" 
                            class="form-input" 
                            placeholder="ê²Œì‹œê¸€ ê²€ìƒ‰..."
                            style="padding-left: 2.5rem;"
                        >
                        <span style="position: absolute; left: 0.75rem; top: 50%; transform: translateY(-50%);">ğŸ”</span>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs-container reveal-up">
                    <div class="tabs-header" style="display: flex; gap: 0.5rem; border-bottom: 2px solid var(--border); margin-bottom: 1.5rem;">
                        <button class="tab-button active" data-tab="notice">
                            <span>ğŸ””</span>
                            <span class="hidden-sm">ê³µì§€</span>
                        </button>
                        <button class="tab-button" data-tab="materials">
                            <span>ğŸ“„</span>
                            <span class="hidden-sm">ê°•ì˜ìë£Œ ê³µìœ </span>
                        </button>
                        <button class="tab-button" data-tab="qna">
                            <span>â“</span>
                            <span class="hidden-sm">Q&A</span>
                        </button>
                        <button class="tab-button" data-tab="reviews">
                            <span>â­</span>
                            <span class="hidden-sm">í›„ê¸°/ì‚¬ë¡€</span>
                        </button>
                    </div>

                    <!-- Tab Contents -->
                    <div class="tab-content active" id="tab-notice">
                        <div class="post-list" id="post-list-notice">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                    <div class="tab-content" id="tab-materials" style="display: none;">
                        <div class="post-list" id="post-list-materials">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                    <div class="tab-content" id="tab-qna" style="display: none;">
                        <div class="post-list" id="post-list-qna">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                    <div class="tab-content" id="tab-reviews" style="display: none;">
                        <div class="post-list" id="post-list-reviews">
                            <!-- Posts will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Post Detail Modal -->
    <div class="modal-overlay" id="post-modal">
        <div class="modal-content" style="max-width: 800px;">
            <button class="modal-close" style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; font-size: 1.5rem; cursor: pointer;">Ã—</button>
            <div id="post-detail-content">
                <!-- Post detail will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <!-- Scripts -->
    <script src="../js/components.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/animations.js"></script>
    
    <script>
        let currentTab = 'notice';
        let allPosts = {
            notice: [],
            materials: [],
            qna: [],
            reviews: []
        };
        let filteredPosts = {
            notice: [],
            materials: [],
            qna: [],
            reviews: []
        };
        
        $(document).ready(function() {
            // Wait for components to load
            setTimeout(function() {
                // Initialize modal
                if (typeof initModal === 'function') {
                    initModal();
                }
                
                // Check login status
                if (typeof checkLoginStatus === 'function') {
                    checkLoginStatus();
                }
                
                // Load posts
                if (typeof loadPosts === 'function') {
                    loadPosts();
                }
                
                // Initialize tabs
                if (typeof initTabs === 'function') {
                    initTabs();
                }
                
                // Initialize search
                if (typeof initSearch === 'function') {
                    initSearch();
                }
                
                // Initialize animations
                if (typeof initRevealAnimations === 'function') {
                    initRevealAnimations();
                }
            }, 200);
        });
        
        function checkLoginStatus() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            if (isLoggedIn) {
                $('#login-banner').hide();
            }
        }
        
        function loadPosts() {
            // ê³µì§€ì‚¬í•­ì€ localStorageì—ì„œ ë¡œë“œ
            let noticePosts = [];
            try {
                const stored = localStorage.getItem('communityNotices');
                if (stored) {
                    const parsed = JSON.parse(stored);
                    noticePosts = Array.isArray(parsed) ? parsed.filter(n => {
                        return n && n.id && n.title && n.content && n.status === 'published';
                    }).map(n => ({
                        id: n.id,
                        title: n.title,
                        content: n.content,
                        author: n.author || 'ê´€ë¦¬ì',
                        authorRole: n.authorRole || 'ìš´ì˜íŒ€',
                        views: n.views || 0,
                        likes: n.likes || 0,
                        comments: n.comments || 0,
                        createdAt: n.createdAt,
                        tags: n.tags || []
                    })) : [];
                }
            } catch (e) {
                console.error('Error loading notices:', e);
            }

            // Dummy data - Replace with API call
            allPosts = {
                notice: noticePosts,
                materials: [
                    {
                        id: '3',
                        title: 'AI ë§ˆì¼€íŒ… ì‹¤ë¬´ ê°•ì˜ ìë£Œ ê³µìœ ',
                        content: 'AI ë§ˆì¼€íŒ… ì‹¤ë¬´ ê°•ì˜ì—ì„œ ì‚¬ìš©í•œ ìë£Œë¥¼ ê³µìœ í•©ë‹ˆë‹¤.\n\ní¬í•¨ ë‚´ìš©:\n- ë§ˆì¼€íŒ… ì „ëµ í…œí”Œë¦¿\n- GA4 ë¶„ì„ ê°€ì´ë“œ\n- Make.com ì›Œí¬í”Œë¡œìš° ì˜ˆì œ\n\nìë£ŒëŠ” ê°•ì˜ìë£Œ ê³µìœ  íƒ­ì—ì„œ ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.',
                        author: 'ê¹€ê°•ì‚¬',
                        authorRole: 'ë§ˆì¼€íŒ… ì „ë¬¸ê°€',
                        views: 342,
                        likes: 28,
                        comments: 12,
                        createdAt: '2024-02-18',
                        tags: ['ë§ˆì¼€íŒ…', 'ìë£Œ', 'í…œí”Œë¦¿']
                    }
                ],
                qna: [
                    {
                        id: '4',
                        title: 'ê°•ì˜ ìë£Œë¥¼ ìˆ˜ì •í•˜ê³  ì‹¶ì€ë° ì–´ë–»ê²Œ í•˜ë‚˜ìš”?',
                        content: 'ê°•ì˜ ìë£Œ í…œí”Œë¦¿ì„ ë°›ì•˜ëŠ”ë°, ì œ ê°•ì˜ ìŠ¤íƒ€ì¼ì— ë§ê²Œ ìˆ˜ì •í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.\n\nì–´ë–¤ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ì„ê¹Œìš”? Notionì„ ì‚¬ìš©í•´ë„ ë ê¹Œìš”?',
                        author: 'ì‹ ê·œê°•ì‚¬',
                        views: 123,
                        likes: 5,
                        comments: 8,
                        createdAt: '2024-02-20',
                        tags: ['ì§ˆë¬¸', 'ìë£Œ']
                    }
                ],
                reviews: [
                    {
                        id: '5',
                        title: 'ê°•ì‚¬ ì„±ì¥ í”„ë¡œê·¸ë¨ í›„ê¸° - ì •ë§ ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤!',
                        content: 'ê°•ì‚¬ ì„±ì¥ í”„ë¡œê·¸ë¨ì„ ìˆ˜ë£Œí•˜ê³  ì²« ê°•ì˜ë¥¼ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.\n\ní”„ë¡œê·¸ë¨ì—ì„œ ë°°ìš´ ì»¤ë¦¬í˜ëŸ¼ ì„¤ê³„ ë°©ë²•ê³¼ ì‹¤ìŠµ ìš´ì˜ ê¸°ë²•ì´ ì •ë§ ë„ì›€ì´ ë˜ì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ í”¼ë“œë°± ë£¨í‹´ì„ ì ìš©í•˜ë‹ˆ í•™ìŠµìë“¤ì˜ ë§Œì¡±ë„ê°€ í¬ê²Œ í–¥ìƒë˜ì—ˆì–´ìš”.\n\në‹¤ë¥¸ ê°•ì‚¬ë¶„ë“¤ë„ ê¼­ ì°¸ì—¬í•´ë³´ì‹œê¸¸ ì¶”ì²œí•©ë‹ˆë‹¤!',
                        author: 'ìµœê°•ì‚¬',
                        authorRole: 'ë””ìì¸ ì „ë¬¸ê°€',
                        views: 289,
                        likes: 42,
                        comments: 18,
                        createdAt: '2024-02-22',
                        tags: ['í›„ê¸°', 'ì¶”ì²œ']
                    }
                ]
            };
            
            filteredPosts = JSON.parse(JSON.stringify(allPosts));
            renderPosts();
        }
        
        function initTabs() {
            $('.tab-button').on('click', function() {
                const tab = $(this).data('tab');
                switchTab(tab);
            });
        }
        
        function switchTab(tab) {
            currentTab = tab;
            
            $('.tab-button').removeClass('active');
            $(`.tab-button[data-tab="${tab}"]`).addClass('active');
            
            $('.tab-content').hide().removeClass('active');
            $(`#tab-${tab}`).show().addClass('active');
            
            renderPosts();
        }
        
        function initSearch() {
            $('#search-input').on('input', debounce(function() {
                const query = $(this).val().toLowerCase();
                filterPosts(query);
            }, 300));
        }
        
        function filterPosts(query) {
            Object.keys(allPosts).forEach(function(category) {
                if (query) {
                    filteredPosts[category] = allPosts[category].filter(function(post) {
                        return post.title.toLowerCase().includes(query) ||
                               post.content.toLowerCase().includes(query);
                    });
                } else {
                    filteredPosts[category] = allPosts[category];
                }
            });
            renderPosts();
        }
        
        function renderPosts() {
            const posts = filteredPosts[currentTab];
            const $list = $(`#post-list-${currentTab}`);
            $list.empty();
            
            if (posts.length === 0) {
                $list.html('<p class="text-center" style="padding: 3rem; color: var(--text-muted);">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</p>');
                return;
            }
            
            posts.forEach(function(post, index) {
                const $post = createPostCard(post, index);
                $list.append($post);
            });
        }
        
        function createPostCard(post, index) {
            const $card = $('<div>')
                .addClass('card card-elevated reveal-up')
                .css({
                    'cursor': 'pointer',
                    'margin-bottom': '1rem',
                    'transition-delay': (index * 0.05) + 's'
                })
                .on('click', function() {
                    showPostDetail(post);
                });
            
            const header = $('<div>').addClass('card-header');
            const title = $('<h3>')
                .addClass('card-title')
                .css({
                    'margin-bottom': '0.5rem',
                    'display': '-webkit-box',
                    '-webkit-line-clamp': '2',
                    '-webkit-box-orient': 'vertical',
                    'overflow': 'hidden'
                })
                .text(post.title);
            
            const description = $('<p>')
                .addClass('card-description')
                .css({
                    'display': '-webkit-box',
                    '-webkit-line-clamp': '2',
                    '-webkit-box-orient': 'vertical',
                    'overflow': 'hidden'
                })
                .text(post.content);
            
            header.append(title, description);
            
            const content = $('<div>').addClass('card-content');
            const meta = $('<div>')
                .css({
                    'display': 'flex',
                    'justify-content': 'space-between',
                    'align-items': 'center',
                    'flex-wrap': 'wrap',
                    'gap': '1rem',
                    'font-size': '0.875rem',
                    'color': 'var(--text-muted)'
                });
            
            const authorInfo = $('<div>')
                .css('display', 'flex')
                .css('align-items', 'center')
                .css('gap', '1rem')
                .html(`
                    <span>${post.author}</span>
                    ${post.authorRole ? `<span class="badge">${post.authorRole}</span>` : ''}
                    <span>${formatDate(post.createdAt)}</span>
                `);
            
            const stats = $('<div>')
                .css('display', 'flex')
                .css('gap', '1rem')
                .html(`
                    <span>ğŸ‘ ${post.views}</span>
                    <span>â¤ ${post.likes}</span>
                    <span>ğŸ’¬ ${post.comments}</span>
                `);
            
            meta.append(authorInfo, stats);
            content.append(meta);
            
            if (post.tags && post.tags.length > 0) {
                const tags = $('<div>')
                    .css({
                        'display': 'flex',
                        'flex-wrap': 'wrap',
                        'gap': '0.5rem',
                        'margin-top': '1rem'
                    });
                
                post.tags.forEach(function(tag) {
                    tags.append($('<span>')
                        .addClass('badge')
                        .css('font-size', '0.75rem')
                        .text(tag)
                    );
                });
                
                content.append(tags);
            }
            
            $card.append(header, content);
            return $card;
        }
        
        function showPostDetail(post) {
            const $modal = $('#post-modal');
            const $content = $('#post-detail-content');
            
            $content.html(`
                <div style="padding: 1rem 0;">
                    <h2 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem;">${post.title}</h2>
                    <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; font-size: 0.875rem; color: var(--text-muted);">
                        <span>${post.author}</span>
                        ${post.authorRole ? `<span class="badge">${post.authorRole}</span>` : ''}
                        <span>${formatDate(post.createdAt)}</span>
                    </div>
                    ${post.tags && post.tags.length > 0 ? `
                    <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 1.5rem;">
                        ${post.tags.map(tag => `<span class="badge">${tag}</span>`).join('')}
                    </div>
                    ` : ''}
                    <div style="line-height: 1.8; white-space: pre-line; margin-bottom: 2rem;">${post.content}</div>
                    <div style="display: flex; gap: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border); font-size: 0.875rem; color: var(--text-muted);">
                        <span>ğŸ‘ ${post.views}</span>
                        <span>â¤ ${post.likes}</span>
                        <span>ğŸ’¬ ${post.comments}</span>
                    </div>
                </div>
            `);
            
            $modal.addClass('active');
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ko-KR', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }
    </script>
    
    <style>
        .tabs-header {
            overflow-x: auto;
        }
        .tab-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-muted);
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        .tab-button:hover {
            color: var(--text);
        }
        .tab-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        .post-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            background-color: var(--secondary);
            color: var(--secondary-foreground);
            border-radius: var(--radius-full);
            font-size: var(--font-size-xs);
            font-weight: 500;
        }
        @media (min-width: 640px) {
            .tabs-header {
                flex-wrap: nowrap;
            }
        }
    </style>
</body>
</html>

